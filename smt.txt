#!/bin/bash
# upback.sh

set -euo pipefail

RESTORE_DIR="/home/user/restore"
mkdir -p "$RESTORE_DIR"

latest_backup=$(find /home/user -maxdepth 1 -type d -name 'Backup-*' | sort -r | head -n 1)

if [ -z "$latest_backup" ]; then
    echo "No backup found."
    exit 1
fi

for file in "$latest_backup"/*; do
    name=$(basename "$file")
    # исключаем версионные файлы
    if [[ "$name" =~ \.[0-9]{4}-[0-9]{2}-[0-9]{2}$ ]]; then
        continue
    fi
    cp "$file" "$RESTORE_DIR/$name"
done

echo "Restored files from $(basename "$latest_backup") to $RESTORE_DIR"
